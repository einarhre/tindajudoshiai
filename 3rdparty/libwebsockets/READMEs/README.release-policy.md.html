<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README.release-policy</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="lws-release-policy">lws release policy</h1>
<h2 id="master-branch">Master branch</h2>
<p>Master branch is the default and all new work happens there. It’s unstable and subject to history rewrites, patches moving about and being squashed etc. In terms of it working, it is subject to passing CI tests including a battery of runtime tests, so if it is passing CI as it usually is then it’s probably in usable shape.</p>
<figure>
<img src="../doc-assets/lws-relpol-1.svg" alt="all work happens on master" /><figcaption>all work happens on master</figcaption>
</figure>
<p>If you have patches (you are a hero) they should be targeted at master.</p>
<p>To follow such a branch, <code>git pull</code> is the wrong tool… the starting point of what you currently have may no longer exist remotely due to rearranging the patches there. Instead use a flow like this:</p>
<pre><code> $ git fetch https://libwebsockets.org/repo/libwebsockets +master:m &amp;&amp; git reset --hard m</code></pre>
<p>This fetches current remote master into local branch <code>m</code>, and then forces your local checkout to exactly match <code>m</code>. This replaces your checked-out tree including any of your local changes, so stash those first, or use stgit or so to pop them before updating your basis against lws master.</p>
<h2 id="stable-branches">Stable branches</h2>
<p>Master is very useful for coordinating development, and integrating WIP, but for distros or integration into large user projects some stability is often more desirable than the latest development work.</p>
<p>Periodically, when master seems in good shape and various new developments seem to be working, it’s copied out into a versioned stable branch, like <code>v3.0-stable</code>.</p>
<figure>
<img src="../doc-assets/lws-relpol-2.svg" alt="stable branches are copied from master" /><figcaption>stable branches are copied from master</figcaption>
</figure>
<p>The initial copy is tagged with, eg, <code>v3.0.0</code>.</p>
<p>(At that time, master’s logical version is set to “…99”, eg, <code>v3.0.99</code> so version comparisons show that version of master is “later” than any other v3.0 version, which will never reach 99 point releases itself, but “earlier” than, eg, v3.1.)</p>
<h2 id="backport-policy">Backport policy</h2>
<p>Work continues on master, and as part of that usually bugs are reported and / or fixes found that may apply not just to current master, but the version of master that was copied to form the last -stable branch.</p>
<p>In that case, the patch may be backported to the last stable branch to also fix the bug there. In the case of refactors or major internal improvements, these typically do not get backported.</p>
<p>This applies only to fixes and public API-neutral internal changes to lws… if new features were backported or API changes allowed, then there would be multiple apis under the same version name and library soname, which is madness.</p>
<p>When new stable releases are made, the soname is bumped reflecting the API is different than that of previous versions.</p>
<figure>
<img src="../doc-assets/lws-relpol-3.svg" alt="backports from master to stable" /><figcaption>backports from master to stable</figcaption>
</figure>
<p>If there is something you need in a later lws version that is not backported, you need to either backport it yourself (remember that lws is LGPL and you must provide your changes when you distribute the binary) or use a later lws version. Using a more recent version of lws is almost always the correct way.</p>
<h2 id="stable-point-releases">Stable point releases</h2>
<p>Periodically fix patches pile up on the -stable branch and are tagged out as “point releases”. So if the original stable release was “v3.0.0”, the point release may be “v3.0.1”.</p>
<figure>
<img src="../doc-assets/lws-relpol-4.svg" alt="point releases of stable" /><figcaption>point releases of stable</figcaption>
</figure>
<h2 id="critical-fixes">Critical fixes</h2>
<p>Sometimes a bug is found and fixed that had been hiding for a few versions. If the bug has some security dimension or is otherwise important, we may backport it to a few recent releases, not just the last one. This is pretty uncommon though.</p>
<figure>
<img src="../doc-assets/lws-relpol-5.svg" alt="backport to multiple stable branches" /><figcaption>backport to multiple stable branches</figcaption>
</figure>
</body>
</html>
